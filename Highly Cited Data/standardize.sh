#!/bin/sh

DATAFILE='highly-cited.csv'

sed -r -e '/^[^,]+,,/s/^([^, ]+)([^,]*),,/\1,\2,/' \
	-e 's/[ ,]*$//' \
	-e 's/[[:space:]]*,[[:space:]]*/,/g' \
	-e 't start;:start;s/^([^,]*,[^,]*,[^,]*,)(.*)",(.*)$/\1\2";\3/;t start' \
	-e 's/"//g' \
	-e 's/^([^,]*,[^,]*,[^,]*,)(.*)$/\1"\2"/' \
	"$DATAFILE"
